# Basic concepts of quasispecies simulation

```{r, include=FALSE}
library(yasss)
library(knitr)
knitr::opts_chunk$set(echo = FALSE)
```

```{r, results = 'asis'}
x <- sim_pop(ancestors = paste(rep("A", 500), collapse = ''),
             r0 = 2,
             n_gen = 9,
             n_pop = Inf,
             mutator = list(fun = "mutator_uniform_fun",
                            args = list(mu = 0.1)),
             fitness_evaluator = list(fun = "fitness_evaluator_uniform_fun",
                                      args = NULL))

x$ances_dist <- stringdist(x[1,'the_seq'], x[,'the_seq'], method = 'hamming')

cat("\n\nTable: Individuals per generation and the average distance to the original ancestor for the generation.\n\n")
kable(
x %>% 
  select(gen_num, ances_dist, the_seq) %>% 
  group_by(gen_num) %>%
  summarize(n = n(),
            ances_dist = mean(ances_dist),
            nor_ances_dist = mean(ances_dist) / min(nchar(the_seq)))

)
```
