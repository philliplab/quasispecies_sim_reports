[
["simple-first-simulation.html", "Basic concepts of quasispecies simulation 1 Simple first simulation", " Basic concepts of quasispecies simulation 1 Simple first simulation A first simulation to demonstrate the process and the measuring tools. Table 1.1 shows the configuration that was used to call sim_pop from the yasss package. A high level summary of the entire genealogy is provided in Table 1.2. Table 1.1: Configuration with which sim_pop was called. Argument Value Number of Ancestors 1 Sequence Length 500 r0 2 Number of Generations 9 Minimum Population Size Inf Mutator Function mutator_uniform_fun Mutator: mu 0.1 Fitness Evaluator fitness_evaluator_uniform_fun Additional Fitness Evaluator Arguments None Table 1.2: Individuals per generation and the average distance to the original ancestor for the generation. Gen. Num. n Dist. to Ances. Normalized Dist. Fitness Score Min. Fitness Score 0 1 0.0000 0.0000000 0.8369458 0.8369458 1 2 55.0000 0.1100000 0.1860427 0.1263166 2 4 95.2500 0.1905000 0.5424563 0.2274564 3 8 133.8750 0.2677500 0.4157688 0.1198844 4 16 166.9375 0.3338750 0.3629213 0.0132576 5 32 193.7500 0.3875000 0.5738446 0.0063283 6 64 216.4375 0.4328750 0.4918250 0.0685317 7 128 237.5859 0.4751719 0.4751499 0.0015626 8 256 255.7695 0.5115391 0.4885761 0.0012469 9 512 271.8086 0.5436172 0.5052548 0.0047106 Our primary interested is restricted to the final generation which corresponds to the generation that we will obtain from sequencing a sample. Hence we need to capture some of the key information about the last generation and figure out ways to compare it to other simulations. Three key ways to look at this data is: The average of all the pairwise distances between the sequences. A density plot of the distribution of all the pairwise distances. The deciles / quartiles / some other set of percentiles of the distribution. For now we will present all three. Once we have some solid results to argue about we can look at dropping some of these metrics. The average pairwise HD is 332.7 and normalized by the length of the sequence it is 0.665. The distribution is shown in Figure 1.1 and the deciles are listed in Table 1.3. Figure 1.1: Density plot of the pariwise distances in the last generation Table 1.3: The deciles of the pairwise HDs Decile Value 0% 0.140 10% 0.614 20% 0.644 30% 0.658 40% 0.668 50% 0.676 60% 0.684 70% 0.692 80% 0.700 90% 0.710 100% 0.772 "],
["more-realistic-mu.html", "2 More realistic mu", " 2 More realistic mu Note that the extremely high value of mu (0.1) produces sequences that rapidly diverge radically from the ancestor. To make the simulation a little more realistic, drop the mutation rate down to 1 in 1000 and try again. The average pairwise HD is 7.97 and normalized by the length of the sequence it is 0.016. The distribution is shown in the Figure below and the deciles are listed in the following Table. The last two tables in this section show the arguments used to call sim_pop and a summary of each genealogy. Figure 2.1: Density plot of the pariwise distances in the last generation Table 2.1: The deciles of the pairwise HDs Decile Value 0% 0.000 10% 0.008 20% 0.010 30% 0.012 40% 0.014 50% 0.016 60% 0.018 70% 0.020 80% 0.022 90% 0.024 100% 0.046 Table 2.2: Configuration with which sim_pop was called. Argument Value Number of Ancestors 1 Sequence Length 500 r0 2 Number of Generations 9 Minimum Population Size Inf Mutator Function mutator_uniform_fun Mutator: mu 0.001 Fitness Evaluator fitness_evaluator_uniform_fun Additional Fitness Evaluator Arguments None Table 2.3: Individuals per generation and the average distance to the original ancestor for the generation. Gen. Num. n Dist. to Ances. Normalized Dist. Fitness Score Min. Fitness Score 0 1 0.000000 0.0000000 0.9355159 0.9355159 1 2 1.500000 0.0030000 0.2717207 0.1189166 2 4 2.000000 0.0040000 0.2655947 0.1406067 3 8 2.375000 0.0047500 0.5717637 0.0828137 4 16 2.812500 0.0056250 0.4673959 0.0001896 5 32 3.312500 0.0066250 0.4888013 0.0031476 6 64 3.671875 0.0073438 0.5311201 0.0042502 7 128 4.070312 0.0081406 0.5137966 0.0003388 8 256 4.531250 0.0090625 0.4970978 0.0028176 9 512 4.958984 0.0099180 0.5044995 0.0008841 "],
["small-number-of-simulations.html", "3 Small number of simulations", " 3 Small number of simulations The goal is to compare different simulations to each other. First, we will start with a small number of simulations that we can still pay attention to each individual simulation. Note that here we only consider simulations performed with similar parameters since comparisons based on small number of examples for stochastic processes can be very misleading. The idea is just to expand the chunk that showcases a single simulation by adding in extra density curves and extra rows into the tables. The following tables show some summary metrics for 10 simulations. Figure 3.1: Density plot of the pariwise distances in the last generation Table 3.1: The deciles of the pairwise HDs Sim 0% 10% 20% 30% 40% 50% 60% 70% 80% 90% 100% 1 0 0.020 0.026 0.028 0.030 0.034 0.036 0.038 0.040 0.044 0.070 2 0 0.018 0.020 0.022 0.024 0.026 0.028 0.030 0.034 0.036 0.060 3 0 0.020 0.024 0.028 0.030 0.032 0.034 0.038 0.040 0.044 0.064 4 0 0.020 0.026 0.028 0.030 0.032 0.034 0.038 0.040 0.044 0.068 5 0 0.022 0.024 0.028 0.030 0.032 0.032 0.034 0.038 0.040 0.064 6 0 0.022 0.026 0.030 0.032 0.034 0.036 0.038 0.042 0.046 0.070 7 0 0.018 0.022 0.024 0.028 0.030 0.032 0.034 0.036 0.040 0.064 8 0 0.018 0.022 0.024 0.026 0.028 0.030 0.032 0.036 0.038 0.062 9 0 0.020 0.024 0.028 0.030 0.032 0.034 0.036 0.040 0.044 0.066 10 0 0.020 0.026 0.030 0.032 0.036 0.038 0.040 0.044 0.048 0.070 Table 3.2: Configuration with which sim_pop was called. Argument Value Number of Ancestors 1 Sequence Length 500 r0 2 Number of Generations 9 Minimum Population Size Inf Mutator Function mutator_uniform_fun Mutator: mu 0.001 Fitness Evaluator fitness_evaluator_uniform_fun Additional Fitness Evaluator Arguments None Table 3.3: Individuals per generation and the average distance to the original ancestor for the generation in the first simulation only. Gen. Num. n Dist. to Ances. Normalized Dist. Fitness Score Min. Fitness Score 0 1 0.000000 0.0000000 0.4060635 0.4060635 1 2 1.500000 0.0030000 0.5161756 0.1425046 2 4 2.250000 0.0045000 0.4546546 0.0805797 3 8 3.375000 0.0067500 0.4908514 0.1516315 4 16 4.625000 0.0092500 0.3994794 0.0341332 5 32 5.468750 0.0109375 0.5116247 0.0350018 6 64 6.750000 0.0135000 0.5596458 0.0027664 7 128 7.648438 0.0152969 0.5085869 0.0061460 8 256 8.718750 0.0174375 0.5008904 0.0032925 9 512 9.599609 0.0191992 0.5104587 0.0005219 "],
["sets-of-different-simulations.html", "4 Sets of different simulations", " 4 Sets of different simulations The true goal is to compare sets of simulations where some parameter was varied to each other. Initially due to computational restraints (upgrades needed to yasss as well as some caching facilities), we will restrict this to comparisons of small numbers of simulations (~30) grouped into 2 to 4 groups. The goal here is to show how the distributions and the metrics diverge between the groups. Four data structures are used to track all this: the all_sim_results data.frame - see the few_sim_chunk the group_membership data.frame: sim_id, group_id, group_label and group description arg_sets: A list indexed by group_id. Each element is a list with three elements: group_label: The label used to describe the group group_desc: The full description of the group args: The list of arguments used with do.call to run sim_pop The following graphs and tables present a summary of a set of simulations that can be divided into 2 groups. Table 4.1: The average pairwise HD in each group of simulations group_label avg_hd n_avg_hd mu_002 0.0334 0.0000669 mu_0013 0.0216 0.0000432 Figure 4.1: Density plot of the pariwise distances in the last generation Table 4.2: The deciles of the pairwise HDs Sim 0% 10% 20% 30% 40% 50% 60% 70% 80% 90% 100% mu_002 0 0.02 0.026 0.028 0.03 0.034 0.036 0.038 0.042 0.046 0.082 mu_0013 0 0.012 0.016 0.018 0.02 0.022 0.024 0.026 0.028 0.032 0.058 Table 4.3: Configuration with which sim_pop was called for the group for each group of simulations. group_label Argument Value mu_002 Number of Ancestors 1 mu_002 Sequence Length 500 mu_002 r0 2 mu_002 Number of Generations 9 mu_002 Minimum Population Size Inf mu_002 Mutator Function mutator_uniform_fun mu_002 Mutator: mu 0.002 mu_002 Fitness Evaluator fitness_evaluator_uniform_fun mu_002 Additional Fitness Evaluator Arguments None mu_0013 Number of Ancestors 1 mu_0013 Sequence Length 500 mu_0013 r0 2 mu_0013 Number of Generations 9 mu_0013 Minimum Population Size Inf mu_0013 Mutator Function mutator_uniform_fun mu_0013 Mutator: mu 0.00133333333333333 mu_0013 Fitness Evaluator fitness_evaluator_uniform_fun mu_0013 Additional Fitness Evaluator Arguments None Table 4.4: Individuals per generation and the average distance to the original ancestor for the generation for all simulations grouped by simulation group. group_label Gen. Num. n Dist. to Ances. Normalized Dist. Fitness Score Min. Fitness Score mu_002 0 10 0.000000 0.0000000 0.4900067 0.1078886 mu_002 1 20 1.400000 0.0028000 0.5757264 0.0062575 mu_002 2 40 2.600000 0.0052000 0.4978187 0.0074974 mu_002 3 80 3.787500 0.0075750 0.5076845 0.0172826 mu_002 4 160 4.743750 0.0094875 0.4793084 0.0036512 mu_002 5 320 5.734375 0.0114688 0.4918998 0.0020557 mu_002 6 640 6.715625 0.0134312 0.5036326 0.0018455 mu_002 7 1280 7.685937 0.0153719 0.5004170 0.0000675 mu_002 8 2560 8.686328 0.0173727 0.4940171 0.0000326 mu_002 9 5120 9.681055 0.0193621 0.5013412 0.0002522 mu_0013 0 10 0.000000 0.0000000 0.4482866 0.1082937 mu_0013 1 20 0.500000 0.0010000 0.4940136 0.0013722 mu_0013 2 40 1.350000 0.0027000 0.5361688 0.0326238 mu_0013 3 80 2.062500 0.0041250 0.4558884 0.0051769 mu_0013 4 160 2.731250 0.0054625 0.5376763 0.0183150 mu_0013 5 320 3.378125 0.0067562 0.5204569 0.0009316 mu_0013 6 640 4.056250 0.0081125 0.5201966 0.0006530 mu_0013 7 1280 4.722656 0.0094453 0.4972584 0.0005616 mu_0013 8 2560 5.398047 0.0107961 0.5096068 0.0007339 mu_0013 9 5120 6.062109 0.0121242 0.5025333 0.0000039 "]
]
