<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Basic concepts of quasispecies simulation</title>
  <meta name="description" content="Basic concepts of quasispecies simulation">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="Basic concepts of quasispecies simulation" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Basic concepts of quasispecies simulation" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="small-number-of-simulations.html">

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />










</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="simple-first-simulation.html"><a href="simple-first-simulation.html"><i class="fa fa-check"></i><b>1</b> Simple first simulation</a></li>
<li class="chapter" data-level="2" data-path="more-realistic-mu.html"><a href="more-realistic-mu.html"><i class="fa fa-check"></i><b>2</b> More realistic mu</a></li>
<li class="chapter" data-level="3" data-path="small-number-of-simulations.html"><a href="small-number-of-simulations.html"><i class="fa fa-check"></i><b>3</b> Small number of simulations</a></li>
<li class="chapter" data-level="4" data-path="sets-of-different-simulations.html"><a href="sets-of-different-simulations.html"><i class="fa fa-check"></i><b>4</b> Sets of different simulations</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Basic concepts of quasispecies simulation</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="sets-of-different-simulations" class="section level1">
<h1><span class="header-section-number">4</span> Sets of different simulations</h1>
<p>The true goal is to compare sets of simulations where some parameter was varied to each other. Initially due to computational restraints (upgrades needed to yasss as well as some caching facilities), we will restrict this to comparisons of small numbers of simulations (~30) grouped into 2 to 4 groups. The goal here is to show how the distributions and the metrics diverge between the groups.</p>
<p>Four data structures are used to track all this:</p>
<ul>
<li>the all_sim_results data.frame - see the few_sim_chunk</li>
<li>the group_membership data.frame: sim_id, group_id, group_label and group description</li>
<li>arg_sets: A list indexed by group_id. Each element is a list with three elements:
<ul>
<li>group_label: The label used to describe the group</li>
<li>group_desc: The full description of the group</li>
<li>args: The list of arguments used with do.call to run sim_pop</li>
</ul></li>
</ul>
<p>The following graphs and tables present a summary of a set of simulations that can be divided into 2 groups.</p>
<table>
<caption><span id="tab:unnamed-chunk-17">Table 4.1: </span>The average pairwise HD in each group of simulations</caption>
<thead>
<tr class="header">
<th align="left">group_label</th>
<th align="right">avg_hd</th>
<th align="right">n_avg_hd</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">mu_002</td>
<td align="right">0.0334</td>
<td align="right">0.0000669</td>
</tr>
<tr class="even">
<td align="left">mu_0013</td>
<td align="right">0.0216</td>
<td align="right">0.0000432</td>
</tr>
</tbody>
</table>
<div class="figure"><span id="fig:unnamed-chunk-18"></span>
<img src="_main_files/figure-html/unnamed-chunk-18-1.png" alt="Density plot of the pariwise distances in the last generation" width="672" />
<p class="caption">
Figure 4.1: Density plot of the pariwise distances in the last generation
</p>
</div>
<table>
<caption><span id="tab:unnamed-chunk-19">Table 4.2: </span>The deciles of the pairwise HDs</caption>
<thead>
<tr class="header">
<th align="left">Sim</th>
<th align="left">0%</th>
<th align="left">10%</th>
<th align="left">20%</th>
<th align="left">30%</th>
<th align="left">40%</th>
<th align="left">50%</th>
<th align="left">60%</th>
<th align="left">70%</th>
<th align="left">80%</th>
<th align="left">90%</th>
<th align="left">100%</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">mu_002</td>
<td align="left">0</td>
<td align="left">0.02</td>
<td align="left">0.026</td>
<td align="left">0.028</td>
<td align="left">0.03</td>
<td align="left">0.034</td>
<td align="left">0.036</td>
<td align="left">0.038</td>
<td align="left">0.042</td>
<td align="left">0.046</td>
<td align="left">0.082</td>
</tr>
<tr class="even">
<td align="left">mu_0013</td>
<td align="left">0</td>
<td align="left">0.012</td>
<td align="left">0.016</td>
<td align="left">0.018</td>
<td align="left">0.02</td>
<td align="left">0.022</td>
<td align="left">0.024</td>
<td align="left">0.026</td>
<td align="left">0.028</td>
<td align="left">0.032</td>
<td align="left">0.058</td>
</tr>
</tbody>
</table>
<table>
<caption><span id="tab:unnamed-chunk-20">Table 4.3: </span>Configuration with which sim_pop was called for the group for each group of simulations.</caption>
<thead>
<tr class="header">
<th align="left">group_label</th>
<th align="left">Argument</th>
<th align="left">Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">mu_002</td>
<td align="left">Number of Ancestors</td>
<td align="left">1</td>
</tr>
<tr class="even">
<td align="left">mu_002</td>
<td align="left">Sequence Length</td>
<td align="left">500</td>
</tr>
<tr class="odd">
<td align="left">mu_002</td>
<td align="left">r0</td>
<td align="left">2</td>
</tr>
<tr class="even">
<td align="left">mu_002</td>
<td align="left">Number of Generations</td>
<td align="left">9</td>
</tr>
<tr class="odd">
<td align="left">mu_002</td>
<td align="left">Minimum Population Size</td>
<td align="left">Inf</td>
</tr>
<tr class="even">
<td align="left">mu_002</td>
<td align="left">Mutator Function</td>
<td align="left">mutator_uniform_fun</td>
</tr>
<tr class="odd">
<td align="left">mu_002</td>
<td align="left">Mutator: mu</td>
<td align="left">0.002</td>
</tr>
<tr class="even">
<td align="left">mu_002</td>
<td align="left">Fitness Evaluator</td>
<td align="left">fitness_evaluator_uniform_fun</td>
</tr>
<tr class="odd">
<td align="left">mu_002</td>
<td align="left">Additional Fitness Evaluator Arguments</td>
<td align="left">None</td>
</tr>
<tr class="even">
<td align="left">mu_0013</td>
<td align="left">Number of Ancestors</td>
<td align="left">1</td>
</tr>
<tr class="odd">
<td align="left">mu_0013</td>
<td align="left">Sequence Length</td>
<td align="left">500</td>
</tr>
<tr class="even">
<td align="left">mu_0013</td>
<td align="left">r0</td>
<td align="left">2</td>
</tr>
<tr class="odd">
<td align="left">mu_0013</td>
<td align="left">Number of Generations</td>
<td align="left">9</td>
</tr>
<tr class="even">
<td align="left">mu_0013</td>
<td align="left">Minimum Population Size</td>
<td align="left">Inf</td>
</tr>
<tr class="odd">
<td align="left">mu_0013</td>
<td align="left">Mutator Function</td>
<td align="left">mutator_uniform_fun</td>
</tr>
<tr class="even">
<td align="left">mu_0013</td>
<td align="left">Mutator: mu</td>
<td align="left">0.00133333333333333</td>
</tr>
<tr class="odd">
<td align="left">mu_0013</td>
<td align="left">Fitness Evaluator</td>
<td align="left">fitness_evaluator_uniform_fun</td>
</tr>
<tr class="even">
<td align="left">mu_0013</td>
<td align="left">Additional Fitness Evaluator Arguments</td>
<td align="left">None</td>
</tr>
</tbody>
</table>
<table>
<caption><span id="tab:unnamed-chunk-21">Table 4.4: </span>Individuals per generation and the average distance to the original ancestor for the generation for all simulations grouped by simulation group.</caption>
<thead>
<tr class="header">
<th align="left">group_label</th>
<th align="right">Gen.Â Num.</th>
<th align="right">n</th>
<th align="right">Dist. to Ances.</th>
<th align="right">Normalized Dist.</th>
<th align="right">Fitness Score</th>
<th align="right">Min. Fitness Score</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">mu_002</td>
<td align="right">0</td>
<td align="right">10</td>
<td align="right">0.000000</td>
<td align="right">0.0000000</td>
<td align="right">0.4900067</td>
<td align="right">0.1078886</td>
</tr>
<tr class="even">
<td align="left">mu_002</td>
<td align="right">1</td>
<td align="right">20</td>
<td align="right">1.400000</td>
<td align="right">0.0028000</td>
<td align="right">0.5757264</td>
<td align="right">0.0062575</td>
</tr>
<tr class="odd">
<td align="left">mu_002</td>
<td align="right">2</td>
<td align="right">40</td>
<td align="right">2.600000</td>
<td align="right">0.0052000</td>
<td align="right">0.4978187</td>
<td align="right">0.0074974</td>
</tr>
<tr class="even">
<td align="left">mu_002</td>
<td align="right">3</td>
<td align="right">80</td>
<td align="right">3.787500</td>
<td align="right">0.0075750</td>
<td align="right">0.5076845</td>
<td align="right">0.0172826</td>
</tr>
<tr class="odd">
<td align="left">mu_002</td>
<td align="right">4</td>
<td align="right">160</td>
<td align="right">4.743750</td>
<td align="right">0.0094875</td>
<td align="right">0.4793084</td>
<td align="right">0.0036512</td>
</tr>
<tr class="even">
<td align="left">mu_002</td>
<td align="right">5</td>
<td align="right">320</td>
<td align="right">5.734375</td>
<td align="right">0.0114688</td>
<td align="right">0.4918998</td>
<td align="right">0.0020557</td>
</tr>
<tr class="odd">
<td align="left">mu_002</td>
<td align="right">6</td>
<td align="right">640</td>
<td align="right">6.715625</td>
<td align="right">0.0134312</td>
<td align="right">0.5036326</td>
<td align="right">0.0018455</td>
</tr>
<tr class="even">
<td align="left">mu_002</td>
<td align="right">7</td>
<td align="right">1280</td>
<td align="right">7.685937</td>
<td align="right">0.0153719</td>
<td align="right">0.5004170</td>
<td align="right">0.0000675</td>
</tr>
<tr class="odd">
<td align="left">mu_002</td>
<td align="right">8</td>
<td align="right">2560</td>
<td align="right">8.686328</td>
<td align="right">0.0173727</td>
<td align="right">0.4940171</td>
<td align="right">0.0000326</td>
</tr>
<tr class="even">
<td align="left">mu_002</td>
<td align="right">9</td>
<td align="right">5120</td>
<td align="right">9.681055</td>
<td align="right">0.0193621</td>
<td align="right">0.5013412</td>
<td align="right">0.0002522</td>
</tr>
<tr class="odd">
<td align="left">mu_0013</td>
<td align="right">0</td>
<td align="right">10</td>
<td align="right">0.000000</td>
<td align="right">0.0000000</td>
<td align="right">0.4482866</td>
<td align="right">0.1082937</td>
</tr>
<tr class="even">
<td align="left">mu_0013</td>
<td align="right">1</td>
<td align="right">20</td>
<td align="right">0.500000</td>
<td align="right">0.0010000</td>
<td align="right">0.4940136</td>
<td align="right">0.0013722</td>
</tr>
<tr class="odd">
<td align="left">mu_0013</td>
<td align="right">2</td>
<td align="right">40</td>
<td align="right">1.350000</td>
<td align="right">0.0027000</td>
<td align="right">0.5361688</td>
<td align="right">0.0326238</td>
</tr>
<tr class="even">
<td align="left">mu_0013</td>
<td align="right">3</td>
<td align="right">80</td>
<td align="right">2.062500</td>
<td align="right">0.0041250</td>
<td align="right">0.4558884</td>
<td align="right">0.0051769</td>
</tr>
<tr class="odd">
<td align="left">mu_0013</td>
<td align="right">4</td>
<td align="right">160</td>
<td align="right">2.731250</td>
<td align="right">0.0054625</td>
<td align="right">0.5376763</td>
<td align="right">0.0183150</td>
</tr>
<tr class="even">
<td align="left">mu_0013</td>
<td align="right">5</td>
<td align="right">320</td>
<td align="right">3.378125</td>
<td align="right">0.0067562</td>
<td align="right">0.5204569</td>
<td align="right">0.0009316</td>
</tr>
<tr class="odd">
<td align="left">mu_0013</td>
<td align="right">6</td>
<td align="right">640</td>
<td align="right">4.056250</td>
<td align="right">0.0081125</td>
<td align="right">0.5201966</td>
<td align="right">0.0006530</td>
</tr>
<tr class="even">
<td align="left">mu_0013</td>
<td align="right">7</td>
<td align="right">1280</td>
<td align="right">4.722656</td>
<td align="right">0.0094453</td>
<td align="right">0.4972584</td>
<td align="right">0.0005616</td>
</tr>
<tr class="odd">
<td align="left">mu_0013</td>
<td align="right">8</td>
<td align="right">2560</td>
<td align="right">5.398047</td>
<td align="right">0.0107961</td>
<td align="right">0.5096068</td>
<td align="right">0.0007339</td>
</tr>
<tr class="even">
<td align="left">mu_0013</td>
<td align="right">9</td>
<td align="right">5120</td>
<td align="right">6.062109</td>
<td align="right">0.0121242</td>
<td align="right">0.5025333</td>
<td align="right">0.0000039</td>
</tr>
</tbody>
</table>

</div>
            </section>

          </div>
        </div>
      </div>
<a href="small-number-of-simulations.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "sepia",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
